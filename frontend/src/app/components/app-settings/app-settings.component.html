<h2 mat-dialog-title>{{ 'settings.title' | transloco }}</h2>
<mat-dialog-content>
  <div class="platform-tile-container">
    <div class="platform-tile theme-settings-tile">
      <div class="theme-settings-header">
        <mat-icon>palette</mat-icon>
        <div>
          <h3>{{ 'settings.theme.title' | transloco }}</h3>
          <p class="theme-settings-subtitle">{{ 'settings.theme.description' | transloco }}</p>
        </div>
      </div>

      <mat-form-field appearance="fill" class="theme-select">
        <mat-label>{{ 'settings.theme.label' | transloco }}</mat-label>
        <mat-select [value]="appSettings.defaultTheme" (selectionChange)="setTheme($event.value)">
          @for (theme of availableThemes; track theme) {
            <mat-option [value]="theme">
              {{ theme | titlecase }}
            </mat-option>
          }
        </mat-select>
      </mat-form-field>

      <mat-button-toggle-group [hideSingleSelectionIndicator]="true" [value]="appSettings.themeMode"
        (change)="setThemeMode($event.value)" class="theme-toggle-group" exclusive
        [attr.aria-label]="'settings.theme.modeLabel' | transloco">
        <mat-button-toggle value="light">
          <mat-icon>light_mode</mat-icon>
          {{ 'settings.theme.mode.light' | transloco }}
        </mat-button-toggle>
        <mat-button-toggle value="dark">
          <mat-icon>dark_mode</mat-icon>
          {{ 'settings.theme.mode.dark' | transloco }}
        </mat-button-toggle>
        <mat-button-toggle value="system">
          <mat-icon>settings</mat-icon>
          {{ 'settings.theme.mode.system' | transloco }}
        </mat-button-toggle>
      </mat-button-toggle-group>
    </div>

    <div class="platform-tile language-settings-tile">
      <div class="language-settings-header">
        <mat-icon>translate</mat-icon>
        <div>
          <h3>{{ 'settings.language.title' | transloco }}</h3>
          <p class="language-settings-subtitle">{{ 'settings.language.description' | transloco }}</p>
        </div>
      </div>

      <mat-button-toggle-group [hideSingleSelectionIndicator]="true" [value]="languageService.languageMode()"
        (change)="setLanguageMode($event.value)" class="language-toggle-group" exclusive
        [attr.aria-label]="'settings.language.title' | transloco">
        <mat-button-toggle value="system">
          <mat-icon>public</mat-icon>
          {{ 'settings.language.optionSystem' | transloco }}
        </mat-button-toggle>
        <mat-button-toggle value="en">
          <mat-icon>language</mat-icon>
          {{ 'settings.language.optionEnglish' | transloco }}
        </mat-button-toggle>
        <mat-button-toggle value="de">
          <mat-icon>language</mat-icon>
          {{ 'settings.language.optionGerman' | transloco }}
        </mat-button-toggle>
      </mat-button-toggle-group>
    </div>

    @if(showDetectLocationOnStart){
      <div class="platform-tile">
        <app-enable-location (enabledChange)="setDetectLocationOnStart($event)"></app-enable-location>
      </div>
    }
    @if(storagePersistenceSupported){
      <div class="platform-tile storage-persistence-tile">
      <div class="storage-persistence-header">
        <mat-icon>inventory_2</mat-icon>
        <div>
          <h3>{{ 'settings.storage.title' | transloco }}</h3>
          <p class="storage-persistence-subtitle">{{ 'settings.storage.description' | transloco }}</p>
        </div>
      </div>
      <p class="storage-persistence-note">
        {{ 'settings.storage.note' | transloco }}
      </p>
      <mat-slide-toggle color="primary" [checked]="appSettings.persistStorage"
          (change)="onStoragePersistenceToggle($event)" [disabled]="storagePersistenceBusy">
          {{ 'settings.storage.toggle' | transloco }}
      </mat-slide-toggle>
      @if(storagePersistenceBusy){
          <small class="storage-persistence-hint">{{ 'settings.storage.applying' | transloco }}</small>
      }
      @if(storagePersistenceWarning){
          <p class="storage-persistence-warning">{{ storagePersistenceWarning }}</p>
      }
      </div>
    }
    <div class="platform-tile backup-exit-tile">
      <div class="backup-exit-header">
        <mat-icon>save</mat-icon>
        <div>
          <h3>{{ 'settings.backup.title' | transloco }}</h3>
          <p class="backup-exit-subtitle">{{ 'settings.backup.description' | transloco }}</p>
        </div>
      </div>
      <p class="backup-exit-note">
        {{ 'settings.backup.note' | transloco }}
      </p>
      <mat-slide-toggle color="primary" [checked]="appSettings.backupOnExit"
        (change)="setBackupOnExit($event.checked)">
        {{ 'settings.backup.toggle' | transloco }}
      </mat-slide-toggle>
    </div>
  </div>

  <mat-chip-set class="version-chipset">
    <mat-chip appearance="outlined" color="primary" disableRipple>
      {{ 'settings.versionLabel' | transloco }} {{ versionInfo.semver }}-{{ versionInfo.build }}-{{ versionInfo.commit }}-{{ versionInfo.timestamp
      }}
    </mat-chip>
  </mat-chip-set>

  <mat-dialog-actions>
    <button mat-button mat-dialog-close cdkFocusInitial (click)="onCloseClick()">{{ 'common.actions.close' | transloco }}</button>
  </mat-dialog-actions>
