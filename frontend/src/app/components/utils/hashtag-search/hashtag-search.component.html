<div class="searchTerm-container">
  <input type="search"
    enterkeyhint="search"
    [placeholder]="'common.hashtagSearch.placeholder' | transloco"
    [(ngModel)]="query"
    (keyup.enter)="search()" />
  <button type="button" (click)="search()" [attr.aria-label]="'common.hashtagSearch.searchAction' | transloco">
    <mat-icon>search</mat-icon>
  </button>
</div>

<mat-dialog-content class="hashtag-search-content">
  @if (errorText()) {
  <p class="state-line state-line--error">{{ errorText() }}</p>
  }

  @if (loadingPublic()) {
  <p class="state-line">{{ 'common.hashtagSearch.searching' | transloco }}</p>
  }

  @if (hasSearched() && !loadingPublic() && !hasAnyResult() && !errorText()) {
  <p class="state-line">{{ 'common.hashtagSearch.noResults' | transloco }}</p>
  }

  @if (viewMode === 'map') {
  <app-hashtag-results-map [items]="mapItems()" [initialCenter]="mapView.center" [initialZoom]="mapView.zoom"
    [selectedItemId]="selectedMapItemId()" (itemSelected)="onMapItemSelected($event)"
    (viewChange)="onViewChange($event)">
  </app-hashtag-results-map>
  } @else {
  <div class="results-grid">
    @for (tile of listTiles(); track tile.id) {
    <article class="result-tile">
      <button type="button" class="result-tile__button"
        [class.result-tile__button--selected]="selectedListTileId() === tile.id"
        (click)="onListTileSelected(tile)">
        <span class="result-tile__icon">
          <mat-icon>{{ tile.icon }}</mat-icon>
        </span>
        <span class="result-tile__category">{{ tile.categoryKey | transloco }}</span>
        <span class="result-tile__title">{{ tile.title }}</span>
        @if (tile.description) {
        <span class="result-tile__description">{{ tile.description }}</span>
        }
        @if (tile.tagsLabel) {
        <span class="result-tile__tags">{{ tile.tagsLabel }}</span>
        }
      </button>
    </article>
    }
  </div>
  }
</mat-dialog-content>

<mat-dialog-actions class="sticky-actions" align="end">
  <button mat-dialog-close mat-icon-button class="action-close"
    [attr.aria-label]="'common.actions.abort' | transloco">
    <mat-icon>close</mat-icon>
  </button>
  <button mat-icon-button type="button" (click)="help.open(helpTopic)"
    [attr.aria-label]="'common.actions.help' | transloco">
    <mat-icon>help</mat-icon>
  </button>
  <button mat-icon-button type="button" (click)="toggleViewMode()"
    [attr.aria-label]="viewMode === 'list' ? ('common.location.switchToMap' | transloco) : ('common.location.switchToList' | transloco)">
    <mat-icon>{{ viewMode === 'list' ? 'map' : 'list' }}</mat-icon>
  </button>
  <button mat-icon-button type="button" (click)="onApply()" [disabled]="!selectedResult()"
    [attr.aria-label]="'common.actions.apply' | transloco">
    <mat-icon>check</mat-icon>
  </button>
</mat-dialog-actions>
